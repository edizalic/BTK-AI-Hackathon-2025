(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[767],{229:(e,s,t)=>{"use strict";t.d(s,{CU:()=>d,UA:()=>c,fF:()=>o,q_:()=>i});var r=t(5155),a=t(2115),n=t(5695),l=t(1541);function i(e){let{children:s,requiredRoles:t=[],fallbackPath:i="/login",requireAuth:o=!0}=e,{user:c,isAuthenticated:d,isLoading:u}=(0,l.A)(),m=(0,n.useRouter)(),x=(0,n.usePathname)();return((0,a.useEffect)(()=>{if(!u){if(o&&!d){let e="/login"!==x?"?returnUrl=".concat(encodeURIComponent(x)):"";m.push("".concat(i).concat(e));return}if(d&&c&&t.length>0&&!t.includes(c.role)){switch(c.role){case"ADMIN":m.push("/admin-portal");break;case"SUPERVISOR_TEACHER":case"TEACHER":m.push("/teacher-portal");break;case"STUDENT":m.push("/student-portal");break;default:m.push("/")}return}}},[d,u,c,t,m,x,i,o]),u)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o&&!d||d&&c&&t.length>0&&!t.includes(c.role)?null:(0,r.jsx)(r.Fragment,{children:s})}function o(e){let{children:s}=e;return(0,r.jsx)(i,{requiredRoles:["STUDENT"],children:s})}function c(e){let{children:s}=e;return(0,r.jsx)(i,{requiredRoles:["TEACHER","SUPERVISOR_TEACHER"],children:s})}function d(e){let{children:s}=e,{isAuthenticated:t,isLoading:i,user:o}=(0,l.A)(),c=(0,n.useRouter)();return((0,a.useEffect)(()=>{if(!i&&t&&o&&o.role){let e=setTimeout(()=>{let e="STUDENT"===o.role?"/student-portal":"TEACHER"===o.role||"SUPERVISOR_TEACHER"===o.role?"/teacher-portal":"ADMIN"===o.role?"/admin-portal":"/";window.location.href=e},500);return()=>clearTimeout(e)}},[t,i,o,c]),i)?(0,r.jsxs)("div",{className:"min-h-screen flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsx)("p",{className:"ml-2 text-gray-600",children:"Loading the dashboard..."})]}):t&&o&&o.role?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading the dashboard..."})]})}):(0,r.jsx)(r.Fragment,{children:s})}},1380:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>E});var r=t(5155),a=t(2115),n=t(5695),l=t(6695),i=t(285),o=t(8950),c=t(4774),d=t(1541),u=t(229),m=t(4840),x=t(9428),h=t(9434);let f=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(m.bL,{className:(0,h.cn)("grid gap-2",t),...a,ref:s})});f.displayName=m.bL.displayName;let j=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(m.q7,{ref:s,className:(0,h.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,r.jsx)(m.C1,{className:"flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})});j.displayName=m.q7.displayName;var p=t(5057),b=t(6126),N=t(5863);let g=a.forwardRef((e,s)=>{let{className:t,value:a,...n}=e;return(0,r.jsx)(N.bL,{ref:s,className:(0,h.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:(0,r.jsx)(N.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});g.displayName=N.bL.displayName;var v=t(6874),y=t.n(v),q=t(5339),w=t(5169),T=t(646),k=t(6561);function E(){var e,s,t,m,x;let h=(0,n.useParams)();(0,n.useRouter)();let{courseId:N,quizId:v}=h,{user:E}=(0,d.A)(),[z,S]=(0,a.useState)(null),[R,A]=(0,a.useState)(0),[C,P]=(0,a.useState)({}),[U,_]=(0,a.useState)(!0),[Q,D]=(0,a.useState)(!1),[I,F]=(0,a.useState)(null),[B,$]=(0,a.useState)(null),[O,L]=(0,a.useState)(!1),[Z,W]=(0,a.useState)(null);(0,a.useEffect)(()=>{H()},[v]),(0,a.useEffect)(()=>{if((null==z?void 0:z.isTimed)&&null!==B&&B>0){let e=setInterval(()=>{$(s=>null!==s&&s<=1?(clearInterval(e),M(),0):null!==s?s-1:null)},1e3);return()=>clearInterval(e)}},[null==z?void 0:z.isTimed,B]);let H=async()=>{try{var e,s,t,r,a,n,l,i,o,c,d,u;_(!0),F(null);let m="".concat("https://vitriolacademy.com:76492","/quiz-attempts/start/").concat(v),x={Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"Content-Type":"application/json"},h=await fetch(m,{method:"POST",headers:x});if(!h.ok){let e=await h.text();throw console.error("❌ Response Error Body:",e),Error("Failed to start quiz: ".concat(h.status," - ").concat(e))}let f=await h.json();console.log("\uD83D\uDCE5 Quiz Attempt Response:",f);let j=(null==(e=f.data)?void 0:e.data)||f.data||f,p={id:j.quizId||v,title:(null==(s=j.quiz)?void 0:s.title)||"Quiz",description:(null==(t=j.quiz)?void 0:t.description)||"",duration:(null==(r=j.quiz)?void 0:r.duration)||"60 minutes",dueDate:(null==(a=j.quiz)?void 0:a.dueDate)||"",isTimed:(null==(n=j.quiz)?void 0:n.isTimed)||!1,attemptsAllowed:(null==(l=j.quiz)?void 0:l.attemptsAllowed)||1,totalQuestions:(null==(o=j.quiz)||null==(i=o.questions)?void 0:i.length)||(null==(c=j.questions)?void 0:c.length)||0,maxPoints:(null==(d=j.quiz)?void 0:d.maxPoints)||100,questions:(null==(u=j.quiz)?void 0:u.questions)||j.questions||[]};if(p.questions&&Array.isArray(p.questions)||(console.warn("⚠️ No questions found in quiz data, using empty array"),p.questions=[]),p.questions=p.questions.map(e=>({...e,options:e.options||[]})),S(p),W(j),p.isTimed){let e=parseInt(p.duration)||60;$(60*e)}}catch(e){console.error("❌ Error loading quiz:",e),F(e instanceof Error?e.message:"Failed to load quiz")}finally{_(!1)}},M=async()=>{if(z&&Z)try{D(!0),F(null);let e={answers:C};console.log("\uD83D\uDCE4 Quiz Submission Request Body:",e),console.log("\uD83D\uDCE4 Quiz Submission URL:","".concat("https://vitriolacademy.com:76492","/quizzes/").concat(v,"/submit"));let s="".concat("https://vitriolacademy.com:76492","/quizzes/").concat(v,"/submit"),t={Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),"Content-Type":"application/json"},r=await fetch(s,{method:"POST",headers:t,body:JSON.stringify(e)});if(!r.ok){let e=await r.text();throw console.error("❌ Quiz submission error:",e),Error("Failed to submit quiz: ".concat(r.status," ").concat(r.statusText," - ").concat(e))}let a=await r.json();console.log("\uD83D\uDCE5 Quiz Submission Response:",a),L(!0),W(a.data||a)}catch(e){console.error("❌ Error submitting quiz:",e),F(e instanceof Error?e.message:"Failed to submit quiz")}finally{D(!1)}};if(U)return(0,r.jsx)(u.q_,{requiredRoles:["STUDENT"],children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Loading quiz..."})]})})});if(I)return(0,r.jsx)(u.q_,{requiredRoles:["STUDENT"],children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800 flex items-center justify-center",children:(0,r.jsx)(l.Zp,{className:"max-w-md",children:(0,r.jsx)(l.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(q.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Quiz"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:I}),(0,r.jsx)(y(),{href:"/courses/".concat(N),children:(0,r.jsx)(i.$,{children:"Back to Course"})})]})})})})});if(!z)return(0,r.jsx)(u.q_,{requiredRoles:["STUDENT"],children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800 flex items-center justify-center",children:(0,r.jsx)(l.Zp,{className:"max-w-md",children:(0,r.jsx)(l.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(q.A,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Quiz Not Found"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"The quiz you're looking for doesn't exist or you don't have access to it."}),(0,r.jsx)(y(),{href:"/courses/".concat(N),children:(0,r.jsx)(i.$,{children:"Back to Course"})})]})})})})});if(!z.questions||0===z.questions.length)return(0,r.jsx)(u.q_,{requiredRoles:["STUDENT"],children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800 flex items-center justify-center",children:(0,r.jsx)(l.Zp,{className:"max-w-md",children:(0,r.jsx)(l.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(q.A,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No Questions Available"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"This quiz doesn't have any questions yet."}),(0,r.jsx)(y(),{href:"/courses/".concat(N),children:(0,r.jsx)(i.$,{children:"Back to Course"})})]})})})})});if(O&&Z)return(0,r.jsx)(u.q_,{requiredRoles:["STUDENT"],children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,r.jsx)(y(),{href:"/courses/".concat(N),children:(0,r.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,r.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Back to Course"]})})}),(0,r.jsxs)(l.Zp,{className:"max-w-2xl mx-auto",children:[(0,r.jsxs)(l.aR,{className:"text-center",children:[(0,r.jsx)(T.A,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,r.jsx)(l.ZB,{className:"text-2xl",children:"Quiz Completed!"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Your quiz has been submitted successfully."})]}),(0,r.jsxs)(l.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Score"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[(null==(s=Z.data)?void 0:s.score)||Z.score||0," / ",(null==(t=Z.data)?void 0:t.maxPoints)||Z.maxPoints||z.maxPoints]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Percentage"}),(0,r.jsxs)("p",{className:"text-2xl font-bold",children:[(null==(m=Z.data)?void 0:m.score)&&(null==(x=Z.data)?void 0:x.maxPoints)?Math.round(Z.data.score/Z.data.maxPoints*100):Z.score&&Z.maxPoints?Math.round(Z.score/Z.maxPoints*100):0,"%"]})]})]}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(y(),{href:"/courses/".concat(N),children:(0,r.jsx)(i.$,{children:"Return to Course"})})})]})]})]})})});let V=z.questions[R],J=R===z.questions.length-1;if(!V)return(0,r.jsx)(u.q_,{requiredRoles:["STUDENT"],children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800 flex items-center justify-center",children:(0,r.jsx)(l.Zp,{className:"max-w-md",children:(0,r.jsx)(l.Wu,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(q.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Question Not Found"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"The requested question could not be found."}),(0,r.jsx)(y(),{href:"/courses/".concat(N),children:(0,r.jsx)(i.$,{children:"Back to Course"})})]})})})})});let Y=(0,r.jsx)(c.Y,{userType:"student"});return(0,r.jsx)(u.q_,{requiredRoles:["STUDENT"],children:(0,r.jsx)(o.CF,{drawerContent:Y,children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(y(),{href:"/courses/".concat(N),children:(0,r.jsxs)(i.$,{variant:"outline",size:"sm",children:[(0,r.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Back to Course"]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:z.title}),(0,r.jsx)("p",{className:"text-muted-foreground",children:z.description})]})]}),z.isTimed&&null!==B&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 text-red-500"}),(0,r.jsx)("span",{className:"font-mono text-lg ".concat(B<300?"text-red-600":"text-foreground"),children:(e=>{let s=Math.floor(e/60);return"".concat(s,":").concat((e%60).toString().padStart(2,"0"))})(B)})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Question ",R+1," of ",z.questions.length]}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Object.keys(C).length," of ",z.questions.length," answered"]})]}),(0,r.jsx)(g,{value:z?(R+1)/z.questions.length*100:0,className:"h-2"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:z.questions.map((e,s)=>(0,r.jsx)(i.$,{variant:s===R?"default":"outline",size:"sm",onClick:()=>A(s),className:"w-10 h-10 p-0",children:s+1},s))})}),(0,r.jsxs)(l.Zp,{className:"mb-8",children:[(0,r.jsx)(l.aR,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(l.ZB,{className:"text-xl",children:["Question ",R+1]}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:[V.points," points"]})]}),(0,r.jsxs)(b.E,{variant:"secondary",children:[V.options.length," options"]})]})}),(0,r.jsx)(l.Wu,{className:"space-y-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg mb-4",children:V.question}),(0,r.jsx)(f,{value:(null==(e=C[V.id])?void 0:e.toString())||"",onValueChange:e=>{var s,t;return s=V.id,t=parseInt(e),void P(e=>({...e,[s]:t}))},children:V.options.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(j,{value:s.toString(),id:"option-".concat(s)}),(0,r.jsx)(p.J,{htmlFor:"option-".concat(s),className:"text-base cursor-pointer",children:e})]},s))})]})})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(i.$,{variant:"outline",onClick:()=>A(e=>Math.max(0,e-1)),disabled:0===R,children:"Previous"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[!J&&(0,r.jsx)(i.$,{onClick:()=>A(e=>e+1),children:"Next"}),J&&(0,r.jsx)(i.$,{onClick:M,disabled:Q||0===Object.keys(C).length,children:Q?"Submitting...":"Submit Quiz"})]})]}),I&&(0,r.jsx)(l.Zp,{className:"mt-6 border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20",children:(0,r.jsx)(l.Wu,{className:"pt-6",children:(0,r.jsx)("p",{className:"text-red-600 dark:text-red-400",children:I})})})]})})})})}},5057:(e,s,t)=>{"use strict";t.d(s,{J:()=>c});var r=t(5155),a=t(2115),n=t(968),l=t(2085),i=t(9434);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(n.b,{ref:s,className:(0,i.cn)(o(),t),...a})});c.displayName=n.b.displayName},5384:(e,s,t)=>{Promise.resolve().then(t.bind(t,1380))},6126:(e,s,t)=>{"use strict";t.d(s,{E:()=>i});var r=t(5155);t(2115);var a=t(2085),n=t(9434);let l=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(l({variant:t}),s),...a})}}},e=>{e.O(0,[874,794,352,423,886,541,828,441,964,358],()=>e(e.s=5384)),_N_E=e.O()}]);