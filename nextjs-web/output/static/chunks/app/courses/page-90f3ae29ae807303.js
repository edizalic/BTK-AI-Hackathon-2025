(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{229:(e,t,r)=>{"use strict";r.d(t,{CU:()=>d,UA:()=>i,fF:()=>c,q_:()=>a});var s=r(5155),l=r(2115),n=r(5695),o=r(1541);function a(e){let{children:t,requiredRoles:r=[],fallbackPath:a="/login",requireAuth:c=!0}=e,{user:i,isAuthenticated:d,isLoading:u}=(0,o.A)(),m=(0,n.useRouter)(),x=(0,n.usePathname)();return((0,l.useEffect)(()=>{if(!u){if(c&&!d){let e="/login"!==x?"?returnUrl=".concat(encodeURIComponent(x)):"";m.push("".concat(a).concat(e));return}if(d&&i&&r.length>0&&!r.includes(i.role)){switch(i.role){case"ADMIN":m.push("/admin-portal");break;case"SUPERVISOR_TEACHER":case"TEACHER":m.push("/teacher-portal");break;case"STUDENT":m.push("/student-portal");break;default:m.push("/")}return}}},[d,u,i,r,m,x,a,c]),u)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c&&!d||d&&i&&r.length>0&&!r.includes(i.role)?null:(0,s.jsx)(s.Fragment,{children:t})}function c(e){let{children:t}=e;return(0,s.jsx)(a,{requiredRoles:["STUDENT"],children:t})}function i(e){let{children:t}=e;return(0,s.jsx)(a,{requiredRoles:["TEACHER","SUPERVISOR_TEACHER"],children:t})}function d(e){let{children:t}=e,{isAuthenticated:r,isLoading:a,user:c}=(0,o.A)(),i=(0,n.useRouter)();return((0,l.useEffect)(()=>{if(!a&&r&&c&&c.role){let e=setTimeout(()=>{let e="STUDENT"===c.role?"/student-portal":"TEACHER"===c.role||"SUPERVISOR_TEACHER"===c.role?"/teacher-portal":"ADMIN"===c.role?"/admin-portal":"/";window.location.href=e},500);return()=>clearTimeout(e)}},[r,a,c,i]),a)?(0,s.jsxs)("div",{className:"min-h-screen flex items-center justify-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,s.jsx)("p",{className:"ml-2 text-gray-600",children:"Loading the dashboard..."})]}):r&&c&&c.role?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading the dashboard..."})]})}):(0,s.jsx)(s.Fragment,{children:t})}},6685:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(5155),l=r(2115),n=r(8950),o=r(4774),a=r(6695),c=r(285),i=r(9434),d=r(6874),u=r.n(d),m=r(229),x=r(1541),h=r(4247),f=r(9076);let g=e=>{let{course:t}=e;return(0,s.jsxs)(a.Zp,{className:"hover:shadow-md transition-all duration-200",children:[(0,s.jsx)(a.aR,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(a.ZB,{className:"text-lg font-semibold text-foreground",children:t.name}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:t.code})]}),(0,s.jsx)("span",{className:(0,i.cn)("px-2 py-1 rounded-full text-xs font-medium capitalize",(e=>{switch(e){case"active":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"completed":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"upcoming":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"}})(t.status)),children:t.status})]})}),(0,s.jsxs)(a.Wu,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-xs",children:t.instructor.name.split(" ").map(e=>e[0]).join("")}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"font-medium text-foreground text-sm",children:t.instructor.name})})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("p",{className:"text-foreground font-medium",children:[t.schedule.days.map(e=>e.charAt(0).toUpperCase()+e.slice(1,3)).join(", ")," â€¢ ",t.schedule.startTime]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:t.schedule.location})]}),(0,s.jsx)(u(),{href:"/courses/".concat(t.id),children:(0,s.jsx)(c.$,{variant:"default",size:"sm",className:"w-full",children:"View Course Details"})})]})]})};function p(){let{user:e}=(0,x.A)(),{courses:t,loading:r,error:a}=(()=>{let{user:e}=(0,x.A)(),[t,r]=(0,l.useState)([]),[s,n]=(0,l.useState)(!0),[o,a]=(0,l.useState)(null);return(0,l.useEffect)(()=>{(async()=>{if(e)try{var t,s;n(!0),a(null),console.log("=== LOADING COURSES FOR USER ==="),console.log("User role:",e.role),console.log("User ID:",e.id),console.log("User department:",null==(t=e.profile)?void 0:t.department);let l=(await h.nC.courses.getCourses({})).courses||[];console.log("Total courses available:",l.length);let o=[];if("STUDENT"===e.role){console.log("=== LOADING ENROLLED COURSES FOR STUDENT ==="),console.log("Student ID:",e.id);try{let t=await h.nC.enrollment.getStudentEnrollments(e.id);console.log("Full enrollment response:",t);let r=t.enrollments||[];console.log("Enrollments found:",r.length);let s=r.filter(e=>"ACTIVE"===e.status).map(e=>e.course).filter(e=>e);console.log("Student enrolled courses:",s.length),console.log("Enrolled courses:",s.map(e=>({code:e.code,name:e.name}))),o=s}catch(e){console.warn("Failed to load enrolled courses, falling back to all courses:",e),o=l}}else if("TEACHER"===e.role)console.log("=== FILTERING COURSES FOR TEACHER ==="),console.log("Teacher ID:",e.id),o=l.filter(t=>{var r,s;let l=t.instructorId===e.id;return console.log("Course ".concat(t.code,":"),{instructorId:t.instructorId,userId:e.id,instructor:(null==(r=t.instructor)?void 0:r.profile)?"".concat(t.instructor.profile.firstName," ").concat(t.instructor.profile.lastName):null==(s=t.instructor)?void 0:s.email,isInstructor:l,instructorIdType:typeof t.instructorId,userIdType:typeof e.id}),l}),console.log("=== TEACHER FILTERING RESULTS ==="),console.log("Teacher: Filtered to courses they teach:",o.length),console.log("Teacher courses:",o.map(e=>{var t,r;return{code:e.code,name:e.name,instructorId:e.instructorId,instructor:(null==(t=e.instructor)?void 0:t.profile)?"".concat(e.instructor.profile.firstName," ").concat(e.instructor.profile.lastName):null==(r=e.instructor)?void 0:r.email}}));else if("SUPERVISOR_TEACHER"===e.role){let t=null==(s=e.profile)?void 0:s.department;o=l.filter(r=>{var s,l;let n=r.createdById===e.id,o=(null==(l=r.instructor)||null==(s=l.profile)?void 0:s.department)===t,a=n||o;return console.log("Course ".concat(r.code,": createdBy=").concat(n,", instrInDept=").concat(o,", matches=").concat(a)),a}),console.log("Supervisor: Filtered to department courses:",o.length)}else o=l,console.log("Admin: Showing all courses");let c=o.map(e=>{var t,r,s,l,n,o;return{id:e.id,code:e.code,name:e.name,description:e.description,credits:e.credits,schedule:{days:e.scheduleDays,startTime:e.startTime,endTime:e.endTime,location:e.location,building:e.building,room:e.room},instructor:{id:(null==(t=e.instructor)?void 0:t.id)||"",name:(null==(r=e.instructor)?void 0:r.profile)?"".concat(e.instructor.profile.firstName," ").concat(e.instructor.profile.lastName):"Unknown",email:(null==(s=e.instructor)?void 0:s.email)||"",avatar:null==(l=e.instructor)?void 0:l.avatar},semester:e.semester,year:e.year,capacity:e.capacity,enrolled:e.enrolled,status:e.status.toLowerCase(),prerequisites:[],category:e.category,department:(null==(o=e.instructor)||null==(n=o.profile)?void 0:n.department)||"",level:e.level.toLowerCase(),startDate:e.startDate,endDate:e.endDate,enrollmentDeadline:e.enrollmentDeadline}});console.log("Final courses for display:",c.length),r(c)}catch(e){console.error("Failed to load courses:",e),a(e instanceof Error?e.message:"Failed to load courses data")}finally{n(!1)}})()},[e]),{courses:t,loading:s,error:o}})(),i={name:(null==e?void 0:e.profile)?"".concat(e.profile.firstName," ").concat(e.profile.lastName):"Guest User",email:(null==e?void 0:e.email)||"guest@example.com"},d=(null==e?void 0:e.role)==="STUDENT"?"student":"teacher",u=(0,s.jsx)(o.Y,{userType:d,userData:i});return(0,s.jsxs)(m.q_,{requiredRoles:["STUDENT","TEACHER","SUPERVISOR_TEACHER"],children:[r&&(0,s.jsx)(n.CF,{drawerContent:u,children:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading courses..."})]})})}),a&&(0,s.jsx)(n.CF,{drawerContent:u,children:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-2",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-600",children:a})]})})}),!r&&!a&&(0,s.jsx)(n.CF,{drawerContent:u,children:(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 dark:from-slate-900 dark:to-slate-800",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"student"===d?"My Courses":"Teaching Courses"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"student"===d?"Manage your enrolled courses":"Manage your teaching assignments"})]}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)(f.m,{courseId:"all",courseName:"All Courses"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"student"===d?"My Courses":"Teaching Courses"}),(0,s.jsx)(c.$,{variant:"outline",children:"student"===d?"Browse All Courses":"Course Management"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>(0,s.jsx)(g,{course:e},e.id))})]})]})})})]})}},7805:(e,t,r)=>{Promise.resolve().then(r.bind(r,6685))}},e=>{e.O(0,[874,794,352,541,828,695,441,964,358],()=>e(e.s=7805)),_N_E=e.O()}]);